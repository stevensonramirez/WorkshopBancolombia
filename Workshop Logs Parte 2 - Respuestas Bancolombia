{"version":"6","defaultTimeframe":{"from":"now()-30m","to":"now()"},"defaultSegments":[],"sections":[{"id":"21ecea6e-3e64-4e6d-b4ab-556dbdbb9287","type":"markdown","markdown":"## Sumarización\n* El comando **SUMMARIZE** agrupa logs que tienen los mismos valores para un campo determinado y los agrega.\n* Pueden establecerse nombres de alias para atributos dentro del comando de **SUMMARIZE**.\n* El comando **MAKETIMESERIES** crea una serie temporal a partir de los datos. Proporciona una manera conveniente de representar gráficamente datos no métricos sin procesar (como eventos o logs) a lo largo del tiempo.\n\n### Ejercicio 1\n1. Cuente el número de logs de cada loglevel.\n2. Cuente el número de logs de cada loglevel y cambie el nombre/alias del resultado a \"Nivel\"\n3. Cuente la cantidad de logs de cada loglevel en cada host, eliminando los \"NONE\"\n4. Visualice la cantidad de logs de errores a lo largo del tiempo.\n5. Visualice la cantidad de logs de cada loglevel a lo largo del tiempo.\n6. Visualice la cantidad de logs de cada loglevel a lo largo del tiempo con intervalos de 5 minutos."},{"id":"6cb50b33-ea96-46c6-8144-1823a55ef7d2","type":"dql","title":"Ejercicio 1.1 - Logs por loglevel","showTitle":false,"height":256,"drilldownPath":[],"filterSegments":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| summarize count=count(), by:{loglevel}"},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":"loglevel","categoryAxisLabel":"loglevel","valueAxis":"count","valueAxisLabel":"count"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"loglevel","prefixIcon":"","recordField":"loglevel","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["content"]],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":"auto","displayedFields":["loglevel"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["loglevel"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"value":{"records":[{"loglevel":"DEBUG","count":"29796"},{"loglevel":"ERROR","count":"8596"},{"loglevel":"INFO","count":"462192"},{"loglevel":"NONE","count":"1196940"},{"loglevel":"WARN","count":"822"}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| summarize by:{loglevel}, count = count()","timezone":"America/Bogota","query":"fetch logs\n| summarize count=count(), by:{loglevel}\n","scannedRecords":2837607,"dqlVersion":"V1_0","scannedBytes":4133614896,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-05T00:28:50.636Z","end":"2025-02-05T00:58:50.636Z"},"locale":"en","executionTimeMilliseconds":1347,"notifications":[],"queryId":"60cc7faa-b03a-43c5-bcd4-6d0fa4bd61c6","sampled":false}},"types":[{"mappings":{"loglevel":{"type":"string"},"count":{"type":"long"}},"indexRange":[0,4]}]},"code":200,"notifications":[],"dateTime":"2025-02-05T00:58:52.925Z","input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| summarize count=count(), by:{loglevel}\n"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}}},{"id":"31fa8848-0fe5-4c36-8e64-f7b8756e7424","type":"dql","title":"Ejercicio 1.2 - Logs por loglevel con Alias","showTitle":false,"height":256,"filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| summarize count=count(), by:{Nivel=loglevel}"},"visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["Nivel"],"categoryAxisLabel":"Nivel","valueAxis":["count"],"valueAxisLabel":"count","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"level","prefixIcon":"","recordField":"level","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["content"]],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["Nivel"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["Nivel"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"value":{"records":[{"Nivel":"DEBUG","count":"30178"},{"Nivel":"ERROR","count":"8539"},{"Nivel":"INFO","count":"462395"},{"Nivel":"NONE","count":"1191728"},{"Nivel":"WARN","count":"1262"}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| summarize by:{Nivel = loglevel}, count = count()","timezone":"America/Bogota","query":"fetch logs\n| summarize count=count(), by:{Nivel=loglevel}","scannedRecords":1988447,"dqlVersion":"V1_0","scannedBytes":4097360467,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-05T02:43:41.471Z","end":"2025-02-05T03:13:41.471Z"},"locale":"en","executionTimeMilliseconds":1918,"notifications":[],"queryId":"aa00e356-20a2-43bc-998e-bc5661eea930","sampled":false}},"types":[{"mappings":{"Nivel":{"type":"string"},"count":{"type":"long"}},"indexRange":[0,4]}]},"code":200,"notifications":[],"dateTime":"2025-02-05T03:13:43.556Z","input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| summarize count=count(), by:{Nivel=loglevel}"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}}},{"id":"e84228fd-dd4c-44db-9df2-d7961ccbb38d","type":"dql","title":"Ejercicio 1.3 - Logs por loglevel y host, eliminando los NONE","showTitle":false,"height":284,"drilldownPath":[],"filterSegments":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| filterOut loglevel == \"NONE\"\n| summarize count(), by:{loglevel,host.name}"},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":"host.name","categoryAxisLabel":"host.name","valueAxis":"count()","valueAxisLabel":"count()"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"loglevel","prefixIcon":"","recordField":"loglevel","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["content"]],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":"auto","displayedFields":["loglevel","host.name"],"dataMappings":{"value":"count()"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count()","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["loglevel","host.name"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"code":200,"value":{"records":[{"loglevel":"DEBUG","host.name":"ip-172-31-23-111.ec2.internal","count()":"29156"},{"loglevel":"DEBUG","host.name":"ip-172-31-36-104.ec2.internal","count()":"1"},{"loglevel":"DEBUG","host.name":"ip-172-31-74-188.ec2.internal","count()":"257"},{"loglevel":"DEBUG","host.name":"ip-172-31-85-37.ec2.internal","count()":"353"},{"loglevel":"ERROR","host.name":"aks-default-18490522-vmss_0","count()":"1"},{"loglevel":"ERROR","host.name":"aks-default-18490522-vmss_2","count()":"998"},{"loglevel":"ERROR","host.name":"ip-172-31-23-111.ec2.internal","count()":"40"},{"loglevel":"ERROR","host.name":"ip-172-31-36-104.ec2.internal","count()":"3464"},{"loglevel":"ERROR","host.name":"ip-172-31-7-20.ec2.internal","count()":"3"},{"loglevel":"ERROR","host.name":"ip-172-31-74-188.ec2.internal","count()":"288"},{"loglevel":"ERROR","host.name":"ip-172-31-85-37.ec2.internal","count()":"277"},{"loglevel":"ERROR","host.name":null,"count()":"3508"},{"loglevel":"INFO","host.name":"aks-default-18490522-vmss_0","count()":"9"},{"loglevel":"INFO","host.name":"aks-default-18490522-vmss_2","count()":"121067"},{"loglevel":"INFO","host.name":"astroshop-cartservice-c5667f94d-xn4h2","count()":"6217"},{"loglevel":"INFO","host.name":"astroshop-frauddetectionservice-59f5d5454f-crmtr","count()":"318"},{"loglevel":"INFO","host.name":"astroshop-quoteservice-6fddc47f44-pp7cs","count()":"2866"},{"loglevel":"INFO","host.name":"ip-172-31-23-111.ec2.internal","count()":"43811"},{"loglevel":"INFO","host.name":"ip-172-31-36-104.ec2.internal","count()":"113575"},{"loglevel":"INFO","host.name":"ip-172-31-7-20.ec2.internal","count()":"576"},{"loglevel":"INFO","host.name":"ip-172-31-74-188.ec2.internal","count()":"77538"},{"loglevel":"INFO","host.name":"ip-172-31-85-37.ec2.internal","count()":"40806"},{"loglevel":"INFO","host.name":"lnx1-demo.c.dynatrace-demoability.internal","count()":"11169"},{"loglevel":"INFO","host.name":"my-otel-demo-accountingservice-cb78d6676-prx6q","count()":"103"},{"loglevel":"INFO","host.name":"my-otel-demo-adservice-6f4f57766f-k74g2","count()":"158"},{"loglevel":"INFO","host.name":"my-otel-demo-adservice-fbbb4d578-wg2tb","count()":"165"},{"loglevel":"INFO","host.name":"my-otel-demo-cartservice-64499b759d-847z2","count()":"2507"},{"loglevel":"INFO","host.name":"my-otel-demo-cartservice-6bfc654788-ggnld","count()":"6874"},{"loglevel":"INFO","host.name":"my-otel-demo-frauddetectionservice-5dd7f447c5-tj9fs","count()":"104"},{"loglevel":"INFO","host.name":"my-otel-demo-kafka-6678c45b5c-hdfpz","count()":"1354"},{"loglevel":"INFO","host.name":"my-otel-demo-kafka-8464458d99-nf55m","count()":"1356"},{"loglevel":"INFO","host.name":"my-otel-demo-quoteservice-69cbf5855f-dfjrr","count()":"102"},{"loglevel":"INFO","host.name":null,"count()":"33464"},{"loglevel":"WARN","host.name":"aks-default-18490522-vmss_0","count()":"214"},{"loglevel":"WARN","host.name":"ip-172-31-23-111.ec2.internal","count()":"905"},{"loglevel":"WARN","host.name":"ip-172-31-36-104.ec2.internal","count()":"60"},{"loglevel":"WARN","host.name":"ip-172-31-7-20.ec2.internal","count()":"223"},{"loglevel":"WARN","host.name":"ip-172-31-74-188.ec2.internal","count()":"292"},{"loglevel":"WARN","host.name":"ip-172-31-85-37.ec2.internal","count()":"1"}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filterOut loglevel == \"NONE\"\n| summarize by:{loglevel, host.name}, count()","timezone":"America/Bogota","query":"fetch logs\n| filterOut loglevel == \"NONE\"\n| summarize count(), by:{loglevel,host.name}","scannedRecords":2570069,"dqlVersion":"V1_0","scannedBytes":4142278762,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-05T02:53:14.252Z","end":"2025-02-05T03:23:14.252Z"},"locale":"en","executionTimeMilliseconds":1314,"notifications":[],"queryId":"c6b8f3e4-ce9e-4a22-96e7-6a3ac205a543","sampled":false}},"types":[{"mappings":{"loglevel":{"type":"string"},"host.name":{"type":"string"},"count()":{"type":"long"}},"indexRange":[0,38]}]},"notifications":[],"dateTime":"2025-02-05T03:23:16.383Z","input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| filterOut loglevel == \"NONE\"\n| summarize count(), by:{loglevel,host.name}"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}}},{"id":"d09cbbad-16eb-45a7-b99f-b2e2dc5e52dd","type":"dql","title":"Ejercicio 1.4 - Error logs sobre el tiempo","showTitle":false,"drilldownPath":[],"filterSegments":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n|filter loglevel == \"ERROR\"\n|makeTimeseries errorcount = count()"},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["interval"],"categoryAxisLabel":"interval","valueAxis":["interval"],"valueAxisLabel":"interval","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","xAxisScaling":"analyzedTimeframe","xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"hiddenLegendFields":["interval"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["errorcount"]},"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[{"fields":["errorcount"],"value":"sparkline","id":1738717142261}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":[],"dataMappings":{},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"barChart","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"code":200,"value":{"records":[{"timeframe":{"start":"2025-02-05T00:29:00.000Z","end":"2025-02-05T00:59:15.000Z"},"interval":"15000000000","errorcount":[45,62,77,68,100,71,78,63,70,73,73,72,76,73,68,77,74,74,69,76,71,75,70,77,70,70,72,75,76,69,70,78,68,76,71,89,70,66,71,70,74,69,73,67,77,72,78,71,74,73,77,68,75,73,77,67,76,68,75,91,75,71,76,71,71,75,77,66,74,69,75,68,97,70,65,71,75,70,72,74,70,76,69,77,70,77,69,76,66,95,72,74,70,71,66,71,70,76,70,73,72,74,70,74,71,72,77,75,70,81,83,75,72,72,71,54,43,45,14,null,null]}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter loglevel == \"ERROR\"\n| makeTimeseries errorcount = count()","timezone":"America/Bogota","query":"fetch logs\n|filter loglevel == \"ERROR\"\n|makeTimeseries errorcount = count()","scannedRecords":2844165,"dqlVersion":"V1_0","scannedBytes":163229045,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-05T00:29:06.760Z","end":"2025-02-05T00:59:06.760Z"},"locale":"en","executionTimeMilliseconds":35,"notifications":[],"queryId":"a74b5f17-fab8-439c-a189-a6aef3494935","sampled":false}},"types":[{"mappings":{"timeframe":{"type":"timeframe"},"interval":{"type":"duration"},"errorcount":{"type":"array","types":[{"mappings":{"element":{"type":"double"}},"indexRange":[0,120]}]}},"indexRange":[0,0]}]},"notifications":[],"dateTime":"2025-02-05T00:59:07.191Z","input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n|filter loglevel == \"ERROR\"\n|makeTimeseries errorcount = count()"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}}},{"id":"fc72cb42-4493-4b66-95e3-63669f622148","type":"dql","title":"Ejercicio 1.5 - Logs por loglevel sobre el tiempo","showTitle":false,"drilldownPath":[],"filterSegments":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n|makeTimeseries count(), by:{loglevel}"},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":"loglevel","categoryAxisLabel":"loglevel","valueAxis":"interval","valueAxisLabel":"interval"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["count()"],"leftAxisDimensions":["loglevel"]},"xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"loglevel","prefixIcon":"","recordField":"loglevel","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["content"]],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[{"fields":["count()"],"value":"sparkline","id":1738717151154}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["loglevel"],"dataMappings":{"value":"loglevel"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["loglevel"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"barChart","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"code":200,"value":{"records":[{"timeframe":{"start":"2025-02-05T02:48:30.000Z","end":"2025-02-05T03:18:45.000Z"},"interval":"15000000000","loglevel":"DEBUG","count()":[256,254,255,256,255,255,256,254,255,256,256,255,256,255,256,254,256,254,256,255,255,255,255,256,255,256,256,254,256,254,255,256,255,255,256,254,255,256,255,255,256,255,255,256,256,254,255,255,255,256,255,254,255,255,256,254,255,256,256,255,261,255,256,256,255,255,255,255,255,255,256,255,255,254,256,255,256,254,255,254,255,255,255,255,255,255,255,256,255,255,256,254,255,254,256,255,255,256,256,256,256,255,255,256,255,249,261,256,255,255,255,254,256,256,255,55,3,3,2,null,null]},{"timeframe":{"start":"2025-02-05T02:48:30.000Z","end":"2025-02-05T03:18:45.000Z"},"interval":"15000000000","loglevel":"ERROR","count()":[76,72,63,72,69,71,74,74,70,79,73,76,69,73,70,69,69,76,64,105,69,71,71,71,74,75,75,74,71,76,71,70,79,71,74,49,77,73,75,71,79,72,89,74,76,68,77,68,77,67,72,68,77,66,85,75,70,76,74,70,91,69,68,79,67,78,69,74,69,94,72,77,66,74,73,65,68,76,71,77,68,73,72,74,72,73,71,75,73,76,75,73,60,74,70,73,70,71,94,69,72,67,74,71,73,71,77,74,77,67,76,73,75,64,75,70,47,22,1,null,null]},{"timeframe":{"start":"2025-02-05T02:48:30.000Z","end":"2025-02-05T03:18:45.000Z"},"interval":"15000000000","loglevel":"INFO","count()":[4023,4101,3878,4159,4083,4116,4064,4001,4066,4165,4131,4144,3934,3755,3990,3544,4101,3700,3541,3961,3819,3935,3968,3968,4133,4368,4012,4348,4274,3969,4181,4288,3880,3905,3984,3976,3992,4078,4346,4089,3764,4409,3844,3833,3973,4187,3982,4104,3959,3978,3805,4004,3703,3836,4726,4160,4011,4367,3958,4077,3831,3749,4127,4217,3849,4411,4100,4153,3994,3863,4185,4260,3726,4099,4159,3811,4013,4064,3915,3951,3958,3921,4068,4176,4062,3958,4003,3932,3994,4137,3621,4027,3979,3695,4352,3862,3860,3891,4049,4059,3987,3997,4181,3895,4071,3937,4173,4380,3918,3865,3959,4316,3424,2905,2886,2072,1019,532,218,null,null]},{"timeframe":{"start":"2025-02-05T02:48:30.000Z","end":"2025-02-05T03:18:45.000Z"},"interval":"15000000000","loglevel":"NONE","count()":[9691,10403,8291,9426,11051,9212,10386,9976,10850,10929,11746,11776,10698,10141,11004,9145,10024,9476,10227,9034,11895,10735,10702,11429,11214,9195,10813,10093,9898,10583,10672,11238,9800,11235,11330,8441,10926,9364,11142,10228,9916,9479,11104,9120,11094,11202,10430,10937,10839,9696,9202,9578,10424,8931,11082,8891,10101,11554,10351,10901,10384,9566,9505,9968,10437,10051,10410,10432,10962,10642,12099,10766,10933,9431,10433,7974,11166,9969,11111,9150,10283,11317,11563,11352,10805,9371,10504,9722,10779,9347,10876,10534,9542,10504,12078,11493,10801,8534,10789,10378,10164,9325,11204,8995,10657,10858,11633,12563,10755,9828,9853,10764,9700,6751,6846,5437,2057,34,2,null,null]},{"timeframe":{"start":"2025-02-05T02:48:30.000Z","end":"2025-02-05T03:18:45.000Z"},"interval":"15000000000","loglevel":"WARN","count()":[9,null,6,8,4,6,7,4,5,8,6,7,7,3,7,6,6,4,9,4,8,3,6,8,5,6,7,10,3,5,7,6,8,7,8,6,4,10,5,10,8,4,7,6,11,5,5,6,6,10,1,3,3,6,19,18,30,25,16,13,13,12,21,16,16,15,21,17,16,20,25,28,17,18,18,18,23,20,19,16,14,18,17,19,17,11,23,17,20,14,20,19,16,13,21,15,16,18,14,18,16,21,15,24,18,13,19,21,23,22,23,13,4,2,2,2,8,3,2,null,null]}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| makeTimeseries by:{loglevel}, count()","timezone":"America/Bogota","query":"fetch logs\n|makeTimeseries count(), by:{loglevel}","scannedRecords":2279223,"dqlVersion":"V1_0","scannedBytes":4100318502,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-05T02:48:30.569Z","end":"2025-02-05T03:18:30.569Z"},"locale":"en","executionTimeMilliseconds":1574,"notifications":[],"queryId":"d88f0647-85df-476e-82ab-386fb9030f2b","sampled":false}},"types":[{"mappings":{"timeframe":{"type":"timeframe"},"interval":{"type":"duration"},"loglevel":{"type":"string"},"count()":{"type":"array","types":[{"mappings":{"element":{"type":"double"}},"indexRange":[0,120]}]}},"indexRange":[0,4]}]},"notifications":[],"dateTime":"2025-02-05T03:18:32.790Z","input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n|makeTimeseries count(), by:{loglevel}"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}}},{"id":"fa36b1e4-d96b-44a1-881a-2f64f740ca4c","type":"dql","title":"Ejercicio 1.6 - Logs por loglevel sobre el tiempo en intervalos de 5 minutos","showTitle":false,"filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-1h","to":"now()"},"value":"fetch logs\n|makeTimeseries count(), by:{loglevel}, interval:5m"},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":"loglevel","categoryAxisLabel":"loglevel","valueAxis":"interval","valueAxisLabel":"interval"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle","hiddenLegendFields":["interval"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["count()"],"leftAxisDimensions":["loglevel"]},"xAxisLabel":"timeframe","xAxisIsLabelVisible":false,"leftYAxisSettings":{}},"singleValue":{"showLabel":true,"label":"loglevel","prefixIcon":"","recordField":"loglevel","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["content"]],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[{"fields":["count()"],"value":"sparkline","id":1738717155144}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["loglevel"],"dataMappings":{"value":"loglevel"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"interval","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["loglevel"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"barChart","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"code":200,"value":{"records":[{"timeframe":{"start":"2025-02-04T23:55:00.000Z","end":"2025-02-05T01:00:00.000Z"},"interval":"300000000000","loglevel":"DEBUG","count()":[817,5102,5104,5103,5103,5109,5103,5108,5105,5106,5129,5107,3069]},{"timeframe":{"start":"2025-02-04T23:55:00.000Z","end":"2025-02-05T01:00:00.000Z"},"interval":"300000000000","loglevel":"ERROR","count()":[225,1509,1539,1549,1464,1459,1453,1480,1444,1485,1461,1456,1006]},{"timeframe":{"start":"2025-02-04T23:55:00.000Z","end":"2025-02-05T01:00:00.000Z"},"interval":"300000000000","loglevel":"INFO","count()":[12844,88977,92999,95462,81364,79965,80706,80596,79108,79862,80731,79629,44494]},{"timeframe":{"start":"2025-02-04T23:55:00.000Z","end":"2025-02-05T01:00:00.000Z"},"interval":"300000000000","loglevel":"NONE","count()":[30787,207336,206606,205914,214265,208952,206648,207966,207046,207987,205928,206948,120758]},{"timeframe":{"start":"2025-02-04T23:55:00.000Z","end":"2025-02-05T01:00:00.000Z"},"interval":"300000000000","loglevel":"NOTICE","count()":[null,5,null,null,null,null,null,null,null,null,null,null,null]},{"timeframe":{"start":"2025-02-04T23:55:00.000Z","end":"2025-02-05T01:00:00.000Z"},"interval":"300000000000","loglevel":"WARN","count()":[18,170,114,155,175,135,148,188,112,116,174,131,71]}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| makeTimeseries by:{loglevel}, interval:5m, count()","timezone":"America/Bogota","query":"fetch logs\n|makeTimeseries count(), by:{loglevel}, interval:5m","scannedRecords":4498785,"dqlVersion":"V1_0","scannedBytes":8300947204,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-04T23:59:11.994Z","end":"2025-02-05T00:59:11.994Z"},"locale":"en","executionTimeMilliseconds":2232,"notifications":[],"queryId":"89bd88a5-51cd-4d20-b8e8-8be2f4d6eac0","sampled":false}},"types":[{"mappings":{"timeframe":{"type":"timeframe"},"interval":{"type":"duration"},"loglevel":{"type":"string"},"count()":{"type":"array","types":[{"mappings":{"element":{"type":"double"}},"indexRange":[0,12]}]}},"indexRange":[0,5]}]},"notifications":[],"dateTime":"2025-02-05T00:59:15.144Z","input":{"timeframe":{"from":"now()-1h","to":"now()"},"value":"fetch logs\n|makeTimeseries count(), by:{loglevel}, interval:5m"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}}},{"id":"70dd5e42-1ae1-48b9-a8e7-021b54559d31","type":"markdown","markdown":"## Ordenar resultados con ordenar y limitar resultados\n* De forma predeterminada, el comando **SORT** ordena los logs en orden ascendente.\n* También podemos limitar el número de resultados con el comando **LIMIT**.\n\n### Ejercicio 2\n* Consultar los logs de errores más recientes. Muestre los últimos 5 logs de errores (orden descendente) en los últimos 30 minutos.\n* **Caso de uso:** Tenemos algunos equipos que están poniendo demasiados logs de DEBUG en producción y queremos premiar a los equipos que tienen la **menor** cantidad de logs de DEBUG en este ambiente.  **Cuente la cantidad de logs de este tipo por nombre de contenedor y organícelos en orden ascendiente el tiempo.**"},{"id":"5f592f4f-0e6f-4670-aca3-191cc2c2d570","type":"dql","showTitle":false,"title":"Ejercicio 2.1 - Ultimos 5 logs de errores","filterSegments":[],"drilldownPath":[],"previousFilterSegments":[],"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 5"},"visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":["content","dt.entity.cloud_application","dt.entity.cloud_application_instance","dt.entity.cloud_application_namespace","dt.entity.kubernetes_cluster","dt.kubernetes.cluster.id","dt.kubernetes.workload.kind","dt.kubernetes.workload.name","event.type","k8s.deployment.name","k8s.namespace.name","k8s.pod.name","k8s.pod.uid","loglevel","service.name","status","code.filepath","code.function","code.lineno","dt.auth.origin","k8s.cluster.uid","k8s.node.name","k8s.pod.ip","k8s.workload.kind","k8s.workload.name","otel.scope.name","telemetry.sdk.language","telemetry.sdk.name","telemetry.sdk.version"],"categoryAxisLabel":"content,dt.entity.cloud_application,dt.entity.cloud_application_instance,dt.entity.cloud_application_namespace,dt.entity.kubernetes_cluster,dt.kubernetes.cluster.id,dt.kubernetes.workload.kind,dt.kubernetes.workload.name,event.type,k8s.deployment.name,k8s.namespace.name,k8s.pod.name,k8s.pod.uid,loglevel,service.name,status,code.filepath,code.function,code.lineno,dt.auth.origin,k8s.cluster.uid,k8s.node.name,k8s.pod.ip,k8s.workload.kind,k8s.workload.name,otel.scope.name,telemetry.sdk.language,telemetry.sdk.name,telemetry.sdk.version","valueAxis":[],"valueAxisLabel":"","tooltipVariant":"single"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"timestamp","prefixIcon":"","recordField":"timestamp","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["content"]],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{},"columnTypeOverrides":[{"fields":["content"],"id":1738717158370,"value":"log-content"}]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["content","dt.entity.cloud_application","dt.entity.cloud_application_instance","dt.entity.cloud_application_namespace","dt.entity.kubernetes_cluster","dt.kubernetes.cluster.id","dt.kubernetes.workload.kind","dt.kubernetes.workload.name","event.type","k8s.deployment.name","k8s.namespace.name","k8s.pod.name","k8s.pod.uid","loglevel","service.name","status","code.filepath","code.function","code.lineno","dt.auth.origin","k8s.cluster.uid","k8s.node.name","k8s.pod.ip","k8s.workload.kind","k8s.workload.name","otel.scope.name","telemetry.sdk.language","telemetry.sdk.name","telemetry.sdk.version"],"dataMappings":{"value":"content"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[],"variant":"single","truncationMode":"middle","displayedFields":["content","dt.entity.cloud_application","dt.entity.cloud_application_instance","dt.entity.cloud_application_namespace","dt.entity.kubernetes_cluster","dt.kubernetes.cluster.id","dt.kubernetes.workload.kind","dt.kubernetes.workload.name","event.type","k8s.deployment.name","k8s.namespace.name","k8s.pod.name","k8s.pod.uid","loglevel","service.name","status","code.filepath","code.function","code.lineno","dt.auth.origin","k8s.cluster.uid","k8s.node.name","k8s.pod.ip","k8s.workload.kind","k8s.workload.name","otel.scope.name","telemetry.sdk.language","telemetry.sdk.name","telemetry.sdk.version"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"code":200,"value":{"records":[{"timestamp":"2025-02-04T22:22:20.843000000-05:00","content":"Target page, context or browser has been closed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 343, in run\n    self.execute_next_task()\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 374, in execute_next_task\n    self.execute_task(self._task_queue.pop(0))\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 495, in execute_task\n    task(self.user)\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 60, in wrapFunc\n    raise e\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 131, in pwwrapFunc\n    user.browser_context = await user.browser.new_context(ignore_https_errors=True, base_url=user.host)\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/async_api/_generated.py\", line 14234, in new_context\n    await self._impl_obj.new_context(\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_browser.py\", line 127, in new_context\n    channel = await self._channel.send(\"newContext\", params)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 62, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 492, in wrap_api_call\n    return await cb()\n           ^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 100, in inner_send\n    result = next(iter(done)).result()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n","dt.entity.cloud_application":"CLOUD_APPLICATION-698089F730B6F847","dt.entity.cloud_application_instance":"CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","dt.entity.cloud_application_namespace":"CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B","dt.entity.kubernetes_cluster":"KUBERNETES_CLUSTER-279D12C72068548C","dt.kubernetes.cluster.id":"88ef6294-c825-485c-acf4-75f4b9668609","dt.kubernetes.workload.kind":"deployment","dt.kubernetes.workload.name":"my-otel-demo-loadgenerator","dt.source_entity":["CLOUD_APPLICATION-698089F730B6F847","KUBERNETES_CLUSTER-279D12C72068548C","CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B"],"event.type":"LOG","k8s.deployment.name":"my-otel-demo-loadgenerator","k8s.namespace.name":"obslab-log-problem-detection","k8s.pod.name":"my-otel-demo-loadgenerator-859d55f86f-f4b26","k8s.pod.uid":"ecc0b242-9b5a-401f-a243-db596499b189","loglevel":"ERROR","service.name":"loadgenerator","status":"ERROR","code.filepath":"/usr/local/lib/python3.12/site-packages/locust/user/task.py","code.function":"run","code.lineno":"368","dt.auth.origin":"dt0c01.ENPSRVIVMGF27QNRL5CVRU6I","dt.openpipeline.pipelines":["logs:default"],"k8s.cluster.uid":"88ef6294-c825-485c-acf4-75f4b9668609","k8s.node.name":"ip-172-31-7-20.ec2.internal","k8s.pod.ip":"172.31.0.108","k8s.workload.kind":"deployment","k8s.workload.name":"my-otel-demo-loadgenerator","otel.scope.name":"opentelemetry.sdk._logs._internal","telemetry.sdk.language":"python","telemetry.sdk.name":"opentelemetry","telemetry.sdk.version":"1.25.0"},{"timestamp":"2025-02-04T22:22:19.962000000-05:00","content":"Target page, context or browser has been closed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 343, in run\n    self.execute_next_task()\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 374, in execute_next_task\n    self.execute_task(self._task_queue.pop(0))\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 495, in execute_task\n    task(self.user)\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 60, in wrapFunc\n    raise e\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 131, in pwwrapFunc\n    user.browser_context = await user.browser.new_context(ignore_https_errors=True, base_url=user.host)\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/async_api/_generated.py\", line 14234, in new_context\n    await self._impl_obj.new_context(\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_browser.py\", line 127, in new_context\n    channel = await self._channel.send(\"newContext\", params)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 62, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 492, in wrap_api_call\n    return await cb()\n           ^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 100, in inner_send\n    result = next(iter(done)).result()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n","dt.entity.cloud_application":"CLOUD_APPLICATION-698089F730B6F847","dt.entity.cloud_application_instance":"CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","dt.entity.cloud_application_namespace":"CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B","dt.entity.kubernetes_cluster":"KUBERNETES_CLUSTER-279D12C72068548C","dt.kubernetes.cluster.id":"88ef6294-c825-485c-acf4-75f4b9668609","dt.kubernetes.workload.kind":"deployment","dt.kubernetes.workload.name":"my-otel-demo-loadgenerator","dt.source_entity":["CLOUD_APPLICATION-698089F730B6F847","KUBERNETES_CLUSTER-279D12C72068548C","CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B"],"event.type":"LOG","k8s.deployment.name":"my-otel-demo-loadgenerator","k8s.namespace.name":"obslab-log-problem-detection","k8s.pod.name":"my-otel-demo-loadgenerator-859d55f86f-f4b26","k8s.pod.uid":"ecc0b242-9b5a-401f-a243-db596499b189","loglevel":"ERROR","service.name":"loadgenerator","status":"ERROR","code.filepath":"/usr/local/lib/python3.12/site-packages/locust/user/task.py","code.function":"run","code.lineno":"368","dt.auth.origin":"dt0c01.ENPSRVIVMGF27QNRL5CVRU6I","dt.openpipeline.pipelines":["logs:default"],"k8s.cluster.uid":"88ef6294-c825-485c-acf4-75f4b9668609","k8s.node.name":"ip-172-31-7-20.ec2.internal","k8s.pod.ip":"172.31.0.108","k8s.workload.kind":"deployment","k8s.workload.name":"my-otel-demo-loadgenerator","otel.scope.name":"opentelemetry.sdk._logs._internal","telemetry.sdk.language":"python","telemetry.sdk.name":"opentelemetry","telemetry.sdk.version":"1.25.0"},{"timestamp":"2025-02-04T22:22:19.246000000-05:00","content":"Target page, context or browser has been closed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 343, in run\n    self.execute_next_task()\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 374, in execute_next_task\n    self.execute_task(self._task_queue.pop(0))\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 495, in execute_task\n    task(self.user)\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 60, in wrapFunc\n    raise e\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 131, in pwwrapFunc\n    user.browser_context = await user.browser.new_context(ignore_https_errors=True, base_url=user.host)\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/async_api/_generated.py\", line 14234, in new_context\n    await self._impl_obj.new_context(\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_browser.py\", line 127, in new_context\n    channel = await self._channel.send(\"newContext\", params)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 62, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 492, in wrap_api_call\n    return await cb()\n           ^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 100, in inner_send\n    result = next(iter(done)).result()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n","dt.entity.cloud_application":"CLOUD_APPLICATION-698089F730B6F847","dt.entity.cloud_application_instance":"CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","dt.entity.cloud_application_namespace":"CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B","dt.entity.kubernetes_cluster":"KUBERNETES_CLUSTER-279D12C72068548C","dt.kubernetes.cluster.id":"88ef6294-c825-485c-acf4-75f4b9668609","dt.kubernetes.workload.kind":"deployment","dt.kubernetes.workload.name":"my-otel-demo-loadgenerator","dt.source_entity":["CLOUD_APPLICATION-698089F730B6F847","KUBERNETES_CLUSTER-279D12C72068548C","CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B"],"event.type":"LOG","k8s.deployment.name":"my-otel-demo-loadgenerator","k8s.namespace.name":"obslab-log-problem-detection","k8s.pod.name":"my-otel-demo-loadgenerator-859d55f86f-f4b26","k8s.pod.uid":"ecc0b242-9b5a-401f-a243-db596499b189","loglevel":"ERROR","service.name":"loadgenerator","status":"ERROR","code.filepath":"/usr/local/lib/python3.12/site-packages/locust/user/task.py","code.function":"run","code.lineno":"368","dt.auth.origin":"dt0c01.ENPSRVIVMGF27QNRL5CVRU6I","dt.openpipeline.pipelines":["logs:default"],"k8s.cluster.uid":"88ef6294-c825-485c-acf4-75f4b9668609","k8s.node.name":"ip-172-31-7-20.ec2.internal","k8s.pod.ip":"172.31.0.108","k8s.workload.kind":"deployment","k8s.workload.name":"my-otel-demo-loadgenerator","otel.scope.name":"opentelemetry.sdk._logs._internal","telemetry.sdk.language":"python","telemetry.sdk.name":"opentelemetry","telemetry.sdk.version":"1.25.0"},{"timestamp":"2025-02-04T22:22:19.238000000-05:00","content":"Target page, context or browser has been closed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 343, in run\n    self.execute_next_task()\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 374, in execute_next_task\n    self.execute_task(self._task_queue.pop(0))\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 495, in execute_task\n    task(self.user)\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 60, in wrapFunc\n    raise e\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 131, in pwwrapFunc\n    user.browser_context = await user.browser.new_context(ignore_https_errors=True, base_url=user.host)\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/async_api/_generated.py\", line 14234, in new_context\n    await self._impl_obj.new_context(\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_browser.py\", line 127, in new_context\n    channel = await self._channel.send(\"newContext\", params)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 62, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 492, in wrap_api_call\n    return await cb()\n           ^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 100, in inner_send\n    result = next(iter(done)).result()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n","dt.entity.cloud_application":"CLOUD_APPLICATION-698089F730B6F847","dt.entity.cloud_application_instance":"CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","dt.entity.cloud_application_namespace":"CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B","dt.entity.kubernetes_cluster":"KUBERNETES_CLUSTER-279D12C72068548C","dt.kubernetes.cluster.id":"88ef6294-c825-485c-acf4-75f4b9668609","dt.kubernetes.workload.kind":"deployment","dt.kubernetes.workload.name":"my-otel-demo-loadgenerator","dt.source_entity":["CLOUD_APPLICATION-698089F730B6F847","KUBERNETES_CLUSTER-279D12C72068548C","CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B"],"event.type":"LOG","k8s.deployment.name":"my-otel-demo-loadgenerator","k8s.namespace.name":"obslab-log-problem-detection","k8s.pod.name":"my-otel-demo-loadgenerator-859d55f86f-f4b26","k8s.pod.uid":"ecc0b242-9b5a-401f-a243-db596499b189","loglevel":"ERROR","service.name":"loadgenerator","status":"ERROR","code.filepath":"/usr/local/lib/python3.12/site-packages/locust/user/task.py","code.function":"run","code.lineno":"368","dt.auth.origin":"dt0c01.ENPSRVIVMGF27QNRL5CVRU6I","dt.openpipeline.pipelines":["logs:default"],"k8s.cluster.uid":"88ef6294-c825-485c-acf4-75f4b9668609","k8s.node.name":"ip-172-31-7-20.ec2.internal","k8s.pod.ip":"172.31.0.108","k8s.workload.kind":"deployment","k8s.workload.name":"my-otel-demo-loadgenerator","otel.scope.name":"opentelemetry.sdk._logs._internal","telemetry.sdk.language":"python","telemetry.sdk.name":"opentelemetry","telemetry.sdk.version":"1.25.0"},{"timestamp":"2025-02-04T22:22:18.841000000-05:00","content":"Target page, context or browser has been closed\nTraceback (most recent call last):\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 343, in run\n    self.execute_next_task()\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 374, in execute_next_task\n    self.execute_task(self._task_queue.pop(0))\n  File \"/usr/local/lib/python3.12/site-packages/locust/user/task.py\", line 495, in execute_task\n    task(self.user)\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 60, in wrapFunc\n    raise e\n  File \"/usr/local/lib/python3.12/site-packages/locust_plugins/users/playwright.py\", line 131, in pwwrapFunc\n    user.browser_context = await user.browser.new_context(ignore_https_errors=True, base_url=user.host)\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/async_api/_generated.py\", line 14234, in new_context\n    await self._impl_obj.new_context(\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_browser.py\", line 127, in new_context\n    channel = await self._channel.send(\"newContext\", params)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 62, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 492, in wrap_api_call\n    return await cb()\n           ^^^^^^^^^^\n  File \"/usr/local/lib/python3.12/site-packages/playwright/_impl/_connection.py\", line 100, in inner_send\n    result = next(iter(done)).result()\n             ^^^^^^^^^^^^^^^^^^^^^^^^^\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n","dt.entity.cloud_application":"CLOUD_APPLICATION-698089F730B6F847","dt.entity.cloud_application_instance":"CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","dt.entity.cloud_application_namespace":"CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B","dt.entity.kubernetes_cluster":"KUBERNETES_CLUSTER-279D12C72068548C","dt.kubernetes.cluster.id":"88ef6294-c825-485c-acf4-75f4b9668609","dt.kubernetes.workload.kind":"deployment","dt.kubernetes.workload.name":"my-otel-demo-loadgenerator","dt.source_entity":["CLOUD_APPLICATION-698089F730B6F847","KUBERNETES_CLUSTER-279D12C72068548C","CLOUD_APPLICATION_INSTANCE-25C08DE25D8C9405","CLOUD_APPLICATION_NAMESPACE-B4D5C41AFE22117B"],"event.type":"LOG","k8s.deployment.name":"my-otel-demo-loadgenerator","k8s.namespace.name":"obslab-log-problem-detection","k8s.pod.name":"my-otel-demo-loadgenerator-859d55f86f-f4b26","k8s.pod.uid":"ecc0b242-9b5a-401f-a243-db596499b189","loglevel":"ERROR","service.name":"loadgenerator","status":"ERROR","code.filepath":"/usr/local/lib/python3.12/site-packages/locust/user/task.py","code.function":"run","code.lineno":"368","dt.auth.origin":"dt0c01.ENPSRVIVMGF27QNRL5CVRU6I","dt.openpipeline.pipelines":["logs:default"],"k8s.cluster.uid":"88ef6294-c825-485c-acf4-75f4b9668609","k8s.node.name":"ip-172-31-7-20.ec2.internal","k8s.pod.ip":"172.31.0.108","k8s.workload.kind":"deployment","k8s.workload.name":"my-otel-demo-loadgenerator","otel.scope.name":"opentelemetry.sdk._logs._internal","telemetry.sdk.language":"python","telemetry.sdk.name":"opentelemetry","telemetry.sdk.version":"1.25.0"}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 5","timezone":"America/Bogota","query":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 5","scannedRecords":2525987,"dqlVersion":"V1_0","scannedBytes":119289488,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-05T02:52:48.903Z","end":"2025-02-05T03:22:48.903Z"},"locale":"en","executionTimeMilliseconds":30,"notifications":[],"queryId":"c25b9321-ecb3-471e-afe9-686c12fa94d7","sampled":false}},"types":[{"mappings":{"timestamp":{"type":"timestamp"},"content":{"type":"string"},"dt.entity.cloud_application":{"type":"string"},"dt.entity.cloud_application_instance":{"type":"string"},"dt.entity.cloud_application_namespace":{"type":"string"},"dt.entity.kubernetes_cluster":{"type":"string"},"dt.kubernetes.cluster.id":{"type":"string"},"dt.kubernetes.workload.kind":{"type":"string"},"dt.kubernetes.workload.name":{"type":"string"},"dt.source_entity":{"type":"array","types":[{"mappings":{"element":{"type":"string"}},"indexRange":[0,3]}]},"event.type":{"type":"string"},"k8s.deployment.name":{"type":"string"},"k8s.namespace.name":{"type":"string"},"k8s.pod.name":{"type":"string"},"k8s.pod.uid":{"type":"string"},"loglevel":{"type":"string"},"service.name":{"type":"string"},"status":{"type":"string"},"code.filepath":{"type":"string"},"code.function":{"type":"string"},"code.lineno":{"type":"string"},"dt.auth.origin":{"type":"string"},"dt.openpipeline.pipelines":{"type":"array","types":[{"mappings":{"element":{"type":"string"}},"indexRange":[0,0]}]},"k8s.cluster.uid":{"type":"string"},"k8s.node.name":{"type":"string"},"k8s.pod.ip":{"type":"string"},"k8s.workload.kind":{"type":"string"},"k8s.workload.name":{"type":"string"},"otel.scope.name":{"type":"string"},"telemetry.sdk.language":{"type":"string"},"telemetry.sdk.name":{"type":"string"},"telemetry.sdk.version":{"type":"string"}},"indexRange":[0,4]}]},"notifications":[],"dateTime":"2025-02-05T03:22:49.310Z","input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| filter loglevel == \"ERROR\"\n| sort timestamp desc\n| limit 5"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}}},{"id":"ddfc6c35-a345-45a6-896d-4823f7d82549","type":"dql","showTitle":false,"title":"Ejercicio 2.2 - Contablizar Logs Debug de forma ascendente","height":250,"state":{"input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| filter loglevel == \"DEBUG\"\n| summarize count=count(), by: {k8s.container.name}\n| sort count"},"visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{"layout":"horizontal","categoryAxisTickLayout":"horizontal","scale":"absolute","groupMode":"stacked","colorPaletteMode":"multi-color","categoryAxis":"k8s.container.name","categoryAxisLabel":"k8s.container.name","valueAxis":"count","valueAxisLabel":"count"},"colorPalette":"categorical","valueRepresentation":"absolute","truncationMode":"middle"},"singleValue":{"showLabel":true,"label":"log.source","prefixIcon":"","recordField":"log.source","autoscale":true,"alignment":"center","trend":{"trendType":"auto","isVisible":true},"colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[["content"]],"monospacedFontEnabled":false,"monospacedFontColumns":[],"firstVisibleRowIndex":0,"columnWidths":{"[\"loglevel\"]":97.99715423583984,"[\"log.source\"]":600,"[\"count()\"]":93.73579406738281,"[\"count\"]":83.9914779663086,"[\"debug\"]":87.99715423583984,"[\"k8s.namespace.name\"]":223.98863220214844,"[\"dt.process.name\"]":287.9971618652344},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"displayedFields":["k8s.container.name"],"dataMappings":{"value":"count"},"truncationMode":"middle","colorMode":"color-palette","colorPalette":"blue"},"histogram":{"legend":"auto","yAxis":{"label":"Frequency","scale":"linear"},"colorPalette":"categorical","dataMappings":[{"valueAxis":"count","rangeAxis":""}],"variant":"single","truncationMode":"middle","displayedFields":["k8s.container.name"]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false},"visualization":"table","state":"success","davis":{"includeLogs":true,"davisVisualization":{"isAvailable":true}},"result":{"code":200,"value":{"records":[{"k8s.container.name":"opentelemetry-collector","count":"1"},{"k8s.container.name":"broker-service","count":"6"},{"k8s.container.name":"server","count":"261"},{"k8s.container.name":"problem-operator","count":"346"},{"k8s.container.name":"offerservice","count":"29650"}],"metadata":{"grail":{"canonicalQuery":"fetch logs\n| filter loglevel == \"DEBUG\"\n| summarize by:{k8s.container.name}, count = count()\n| sort count","timezone":"America/Bogota","query":"fetch logs\n| filter loglevel == \"DEBUG\"\n| summarize count=count(), by: {k8s.container.name}\n| sort count","scannedRecords":2520386,"dqlVersion":"V1_0","scannedBytes":182883747,"scannedDataPoints":0,"analysisTimeframe":{"start":"2025-02-05T02:52:46.545Z","end":"2025-02-05T03:22:46.545Z"},"locale":"en","executionTimeMilliseconds":50,"notifications":[],"queryId":"1d7d27db-fd79-4914-bca9-e300f15a9ad5","sampled":false}},"types":[{"mappings":{"k8s.container.name":{"type":"string"},"count":{"type":"long"}},"indexRange":[0,4]}]},"notifications":[],"dateTime":"2025-02-05T03:22:46.814Z","input":{"timeframe":{"from":"now()-30m","to":"now()"},"value":"fetch logs\n| filter loglevel == \"DEBUG\"\n| summarize count=count(), by: {k8s.container.name}\n| sort count"},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"filterSegments":[],"drilldownPath":[],"previousFilterSegments":[]}]}